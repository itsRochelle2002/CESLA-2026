<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin Login - CESLA</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;800&family=DM+Sans:wght@300;400;500;600&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="/css/global.css" />
    <style>
      *,
      *::before,
      *::after {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      body {
        font-family: "DM Sans", sans-serif;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        overflow-x: hidden;
      }

      header {
        padding: 16px 40px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        border-bottom: 1px solid rgba(201, 168, 76, 0.2);
        background: rgba(13, 27, 62, 0.6);
        backdrop-filter: blur(10px);
        animation: slideDown 0.6s ease both;
      }
      @keyframes slideDown {
        from {
          opacity: 0;
          transform: translateY(-16px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .header-back {
        width: 38px;
        height: 38px;
        border-radius: 50%;
        border: 1.5px solid rgba(201, 168, 76, 0.35);
        display: flex;
        align-items: center;
        justify-content: center;
        color: #c9a84c;
        font-size: 1.1rem;
        text-decoration: none;
        transition:
          background 0.2s,
          border-color 0.2s;
      }
      .header-back:hover {
        background: rgba(201, 168, 76, 0.12);
        border-color: rgba(201, 168, 76, 0.6);
      }
      .header-center {
        text-align: center;
      }
      .header-center h1 {
        font-family: "Playfair Display", serif;
        font-size: 1.25rem;
        font-weight: 700;
        color: #fff;
        letter-spacing: 0.3px;
      }
      .header-center h1 span {
        color: #c9a84c;
      }
      .header-center p {
        font-size: 0.62rem;
        font-weight: 500;
        color: rgba(255, 255, 255, 0.35);
        letter-spacing: 2.5px;
        text-transform: uppercase;
        margin-top: 1px;
      }
      .header-spacer {
        width: 38px;
      }

      main {
        flex: 1;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 40px 20px;
        animation: fadeUp 0.6s 0.15s ease both;
      }
      @keyframes fadeUp {
        from {
          opacity: 0;
          transform: translateY(24px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .login-card {
        background: rgba(255, 255, 255, 0.04);
        border: 1px solid rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(20px);
        border-radius: 24px;
        padding: 48px 40px 40px;
        width: 100%;
        max-width: 440px;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 16px;
      }

      .icon-wrap {
        position: relative;
        width: 80px;
        height: 80px;
        margin-bottom: 4px;
      }
      .icon-wrap svg {
        width: 80px;
        height: 80px;
      }
      .icon-ring {
        position: absolute;
        inset: -6px;
        border-radius: 50%;
        border: 1.5px dashed rgba(201, 168, 76, 0.3);
        animation: spin 18s linear infinite;
      }
      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }

      .card-title {
        font-family: "Playfair Display", serif;
        font-size: 1.55rem;
        font-weight: 700;
        color: #fff;
        text-align: center;
      }
      .card-sub {
        font-size: 0.78rem;
        color: rgba(255, 255, 255, 0.4);
        text-align: center;
        margin-top: -8px;
      }

      .admin-badge {
        background: rgba(201, 168, 76, 0.08);
        border: 1px solid rgba(201, 168, 76, 0.25);
        border-radius: 10px;
        padding: 10px 16px;
        font-size: 0.72rem;
        font-weight: 500;
        color: rgba(201, 168, 76, 0.85);
        text-align: center;
        width: 100%;
        letter-spacing: 0.2px;
      }

      .field-group {
        display: flex;
        flex-direction: column;
        gap: 7px;
        width: 100%;
      }
      .field-group label {
        font-size: 0.68rem;
        font-weight: 600;
        color: rgba(255, 255, 255, 0.5);
        letter-spacing: 1.8px;
        text-transform: uppercase;
        padding-left: 2px;
      }
      .input-wrap {
        position: relative;
      }
      .input-wrap input {
        width: 100%;
        padding: 14px 46px 14px 18px;
        background: rgba(255, 255, 255, 0.06);
        border: 1.5px solid rgba(255, 255, 255, 0.1);
        border-radius: 12px;
        font-family: "DM Sans", sans-serif;
        font-size: 0.9rem;
        font-weight: 400;
        color: #fff;
        outline: none;
        transition:
          border-color 0.2s,
          background 0.2s;
      }
      .input-wrap input::placeholder {
        color: rgba(255, 255, 255, 0.2);
      }
      .input-wrap input:focus {
        border-color: rgba(201, 168, 76, 0.5);
        background: rgba(255, 255, 255, 0.09);
      }
      .input-wrap input.error {
        border-color: rgba(231, 76, 60, 0.6);
      }

      .eye-btn {
        position: absolute;
        right: 14px;
        top: 50%;
        transform: translateY(-50%);
        background: none;
        border: none;
        cursor: pointer;
        color: rgba(255, 255, 255, 0.3);
        display: flex;
        align-items: center;
        transition: color 0.2s;
      }
      .eye-btn:hover {
        color: rgba(201, 168, 76, 0.7);
      }
      .eye-btn svg {
        width: 18px;
        height: 18px;
      }

      .error-msg {
        font-size: 0.75rem;
        font-weight: 500;
        color: #e74c3c;
        background: rgba(231, 76, 60, 0.08);
        border: 1px solid rgba(231, 76, 60, 0.2);
        border-radius: 8px;
        padding: 10px 14px;
        text-align: center;
        width: 100%;
        display: none;
      }
      .error-msg.show {
        display: block;
      }

      .btn-login {
        width: 100%;
        padding: 16px;
        background: linear-gradient(
          135deg,
          #c9a84c 0%,
          #e8c96a 50%,
          #c9a84c 100%
        );
        background-size: 200% 100%;
        color: #1a1a2e;
        font-family: "DM Sans", sans-serif;
        font-size: 0.82rem;
        font-weight: 700;
        letter-spacing: 2.5px;
        text-transform: uppercase;
        border: none;
        border-radius: 12px;
        cursor: pointer;
        transition:
          background-position 0.4s,
          transform 0.2s,
          box-shadow 0.2s;
        margin-top: 6px;
      }
      .btn-login:hover {
        background-position: right center;
        transform: translateY(-2px);
        box-shadow: 0 8px 24px rgba(201, 168, 76, 0.3);
      }

      .divider {
        width: 100%;
        display: flex;
        align-items: center;
        gap: 12px;
        margin-top: 4px;
      }
      .divider::before,
      .divider::after {
        content: "";
        flex: 1;
        height: 1px;
        background: rgba(255, 255, 255, 0.07);
      }
      .divider span {
        font-size: 0.65rem;
        color: rgba(255, 255, 255, 0.2);
        letter-spacing: 1px;
      }

      .member-link {
        font-size: 0.72rem;
        color: rgba(255, 255, 255, 0.3);
        text-decoration: none;
        text-align: center;
        transition: color 0.2s;
      }
      .member-link:hover {
        color: rgba(201, 168, 76, 0.7);
      }
      .member-link strong {
        color: rgba(201, 168, 76, 0.6);
        font-weight: 600;
      }

      footer {
        text-align: center;
        padding: 14px 40px 22px;
        border-top: 1px solid rgba(255, 255, 255, 0.06);
      }
      footer p {
        font-size: 0.7rem;
        color: rgba(255, 255, 255, 0.2);
        font-weight: 300;
      }

      @media (max-width: 480px) {
        header {
          padding: 12px 20px;
        }
        .header-center h1 {
          font-size: 1.05rem;
        }
        .login-card {
          padding: 36px 24px 30px;
        }
      }
    </style>
  </head>
  <body>
    <header>
      <a href="/" class="header-back">&#8592;</a>
      <div class="header-center">
        <h1>Admin <span>Login</span></h1>
        <p>CESLA Multi-Purpose Cooperative</p>
      </div>
      <div class="header-spacer"></div>
    </header>

    <main>
      <div class="login-card">
        <div class="icon-wrap">
          <svg
            viewBox="0 0 80 80"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <circle
              cx="40"
              cy="40"
              r="38"
              fill="rgba(201,168,76,0.08)"
              stroke="rgba(201,168,76,0.2)"
              stroke-width="1.5"
            />
            <path
              d="M40 18 L56 25 L56 40 C56 50 40 62 40 62 C40 62 24 50 24 40 L24 25 Z"
              fill="rgba(201,168,76,0.15)"
              stroke="rgba(201,168,76,0.6)"
              stroke-width="1.5"
              stroke-linejoin="round"
            />
            <path
              d="M33 40 L38 45 L48 34"
              stroke="rgba(201,168,76,0.9)"
              stroke-width="2.5"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
          </svg>
          <div class="icon-ring"></div>
        </div>

        <div class="card-title">Administrator Access</div>
        <div class="card-sub">Restricted to authorized personnel only</div>

        <div class="admin-badge">
          üîí &nbsp; This portal is for system administrators only
        </div>

        <div class="field-group">
          <label>Username</label>
          <div class="input-wrap">
            <input
              type="text"
              id="adminUsername"
              placeholder="Enter admin username"
              autocomplete="off"
              onkeydown="if (event.key === 'Enter') handleLogin();"
            />
          </div>
        </div>

        <div class="field-group">
          <label>Password</label>
          <div class="input-wrap">
            <input
              type="password"
              id="adminPassword"
              placeholder="Enter password"
              onkeydown="if (event.key === 'Enter') handleLogin();"
            />
            <button class="eye-btn" type="button" onclick="togglePw()">
              <svg
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" />
                <circle cx="12" cy="12" r="3" />
              </svg>
            </button>
          </div>
        </div>

        <div class="error-msg" id="errorMsg">
          ‚ùå Invalid username or password.
        </div>

        <button class="btn-login" onclick="handleLogin()">
          &#8594; &nbsp; Login as Admin
        </button>

        <div class="divider"><span>OR</span></div>

        <a href="/membership/login" class="member-link">
          Are you a member? &nbsp;<strong>Member Login ‚Üí</strong>
        </a>
      </div>
    </main>

    <footer>
      <p>
        CESLA Multi-Purpose Cooperative &nbsp;&bull;&nbsp; Administrator Portal
        &nbsp;&bull;&nbsp; 2025
      </p>
    </footer>

    <script>
      // Prevent back button returning to login after auth
      if (window.history.replaceState) {
        window.history.replaceState(null, null, window.location.href);
      }

      function togglePw() {
        const i = document.getElementById("adminPassword");
        i.type = i.type === "password" ? "text" : "password";
      }

      function handleLogin() {
        const username = document.getElementById("adminUsername").value.trim();
        const password = document.getElementById("adminPassword").value;
        const errorMsg = document.getElementById("errorMsg");
        const uInput = document.getElementById("adminUsername");
        const pInput = document.getElementById("adminPassword");

        errorMsg.classList.remove("show");
        uInput.classList.remove("error");
        pInput.classList.remove("error");

        if (!username || !password) {
          if (!username) uInput.classList.add("error");
          if (!password) pInput.classList.add("error");
          errorMsg.textContent = "‚ùå Please fill in all fields.";
          errorMsg.classList.add("show");
          return;
        }

        fetch("/membership/admin/login", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ username, password }),
        })
          .then((r) => r.json())
          .then((data) => {
            if (data.success) {
              const _p = new URLSearchParams(window.location.search);
              window.location.href =
                _p.get("from") === "canteen"
                  ? "/canteen/admin"
                  : "/membership/admin/dashboard";
            } else {
              errorMsg.textContent = "‚ùå Invalid username or password.";
              errorMsg.classList.add("show");
              uInput.classList.add("error");
              pInput.classList.add("error");
            }
          })
          .catch(() => {
            errorMsg.textContent = "‚ùå Server error. Please try again.";
            errorMsg.classList.add("show");
          });
      }
    </script>
  </body>
</html>
